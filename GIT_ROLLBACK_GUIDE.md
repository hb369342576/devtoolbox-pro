# Git æäº¤å›æ»šæŒ‡å—

## å¸¸è§åœºæ™¯ä¸è§£å†³æ–¹æ¡ˆ

### åœºæ™¯ 1ï¼šæ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ï¼ˆä¿ç•™æ›´æ”¹ï¼‰â­

**é€‚ç”¨æƒ…å†µ**ï¼šåˆšæäº¤å®Œå‘ç°æœ‰é—®é¢˜ï¼Œæƒ³ä¿®æ”¹åé‡æ–°æäº¤

```bash
# æ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ï¼Œä½†ä¿ç•™æ‰€æœ‰æ›´æ”¹åœ¨å·¥ä½œåŒº
git reset --soft HEAD~1

# ç°åœ¨æ‚¨å¯ä»¥ï¼š
# 1. ä¿®æ”¹æ–‡ä»¶
# 2. é‡æ–° add
# 3. é‡æ–° commit
```

**ç¤ºä¾‹**ï¼š
```bash
git reset --soft HEAD~1
# ä¿®æ”¹æ–‡ä»¶...
git add .
git commit -m "æ­£ç¡®çš„æäº¤ä¿¡æ¯"
```

---

### åœºæ™¯ 2ï¼šæ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ï¼ˆä¸¢å¼ƒæ‰€æœ‰æ›´æ”¹ï¼‰âš ï¸

**é€‚ç”¨æƒ…å†µ**ï¼šå®Œå…¨æƒ³æ”¾å¼ƒè¿™æ¬¡æäº¤å’Œæ‰€æœ‰æ›´æ”¹

```bash
# âš ï¸ å±é™©æ“ä½œï¼ä¼šä¸¢å¤±æ‰€æœ‰æœªæäº¤çš„æ›´æ”¹
git reset --hard HEAD~1
```

---

### åœºæ™¯ 3ï¼šæ’¤é”€æœ€è¿‘ N æ¬¡æäº¤

```bash
# æ’¤é”€æœ€è¿‘ 3 æ¬¡æäº¤ï¼ˆä¿ç•™æ›´æ”¹ï¼‰
git reset --soft HEAD~3

# æ’¤é”€æœ€è¿‘ 3 æ¬¡æäº¤ï¼ˆä¸¢å¼ƒæ›´æ”¹ï¼‰âš ï¸
git reset --hard HEAD~3
```

---

### åœºæ™¯ 4ï¼šå›æ»šåˆ°ç‰¹å®šæäº¤

#### æ­¥éª¤ 1ï¼šæŸ¥çœ‹æäº¤å†å²
```bash
git log --oneline
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
a1b2c3d (HEAD -> main) feat: æ·»åŠ æ–°åŠŸèƒ½
e4f5g6h fix: ä¿®å¤ bug
i7j8k9l docs: æ›´æ–°æ–‡æ¡£
m1n2o3p Initial commit
```

#### æ­¥éª¤ 2ï¼šå›æ»šåˆ°æŒ‡å®šæäº¤
```bash
# å›æ»šåˆ° i7j8k9lï¼ˆä¿ç•™æ›´æ”¹ï¼‰
git reset --soft i7j8k9l

# æˆ–å›æ»šå¹¶ä¸¢å¼ƒæ›´æ”¹ âš ï¸
git reset --hard i7j8k9l
```

---

### åœºæ™¯ 5ï¼šå›æ»šå·²æ¨é€åˆ°è¿œç¨‹çš„æäº¤ ğŸŒ

#### æ–¹æ³• Aï¼šä½¿ç”¨ revertï¼ˆæ¨èï¼Œå®‰å…¨ï¼‰â­

**ä¼˜ç‚¹**ï¼šä¸ä¼šæ”¹å†™å†å²ï¼Œå®‰å…¨ï¼Œé€‚åˆå›¢é˜Ÿåä½œ

```bash
# æŸ¥çœ‹è¦å›æ»šçš„æäº¤
git log --oneline

# åˆ›å»ºä¸€ä¸ªæ–°æäº¤æ¥æ’¤é”€ä¹‹å‰çš„æäº¤
git revert a1b2c3d

# æ¨é€åˆ°è¿œç¨‹
git push origin main
```

**revert å¤šä¸ªæäº¤**ï¼š
```bash
# å›æ»šæœ€è¿‘ 3 ä¸ªæäº¤
git revert HEAD~2..HEAD

# æˆ–æŒ‡å®šèŒƒå›´
git revert a1b2c3d..e4f5g6h
```

#### æ–¹æ³• Bï¼šå¼ºåˆ¶æ¨é€ï¼ˆå±é™©ï¼Œæ…ç”¨ï¼‰âš ï¸

**è­¦å‘Š**ï¼šä¼šæ”¹å†™è¿œç¨‹å†å²ï¼Œå›¢é˜Ÿåä½œæ—¶æ…ç”¨ï¼

```bash
# æœ¬åœ°å›æ»š
git reset --hard HEAD~1

# å¼ºåˆ¶æ¨é€åˆ°è¿œç¨‹
git push --force origin main

# æˆ–æ›´å®‰å…¨çš„å¼ºåˆ¶æ¨é€ï¼ˆæ£€æŸ¥è¿œç¨‹æ˜¯å¦æœ‰æ–°æäº¤ï¼‰
git push --force-with-lease origin main
```

---

### åœºæ™¯ 6ï¼šåªæ’¤é”€æŸä¸ªæ–‡ä»¶çš„æ›´æ”¹

#### æ’¤é”€æœªæš‚å­˜ï¼ˆæœª addï¼‰çš„æ–‡ä»¶
```bash
# æ’¤é”€å•ä¸ªæ–‡ä»¶
git checkout -- æ–‡ä»¶å.txt

# æ’¤é”€æ‰€æœ‰æ–‡ä»¶
git checkout -- .
```

#### æ’¤é”€å·²æš‚å­˜ï¼ˆå·² addï¼‰çš„æ–‡ä»¶
```bash
# å–æ¶ˆæš‚å­˜
git restore --staged æ–‡ä»¶å.txt

# æˆ–ä½¿ç”¨æ—§å‘½ä»¤
git reset HEAD æ–‡ä»¶å.txt
```

#### æ¢å¤åˆ°æŸä¸ªæäº¤çš„æ–‡ä»¶ç‰ˆæœ¬
```bash
# æ¢å¤æ–‡ä»¶åˆ°ç‰¹å®šæäº¤çš„ç‰ˆæœ¬
git checkout a1b2c3d -- æ–‡ä»¶å.txt
```

---

### åœºæ™¯ 7ï¼šæŸ¥çœ‹å¹¶æ¢å¤å·²åˆ é™¤çš„æäº¤

å¦‚æœæ‚¨è¯¯åˆ é™¤äº†æäº¤ï¼Œå¯ä»¥ä½¿ç”¨ reflog æ‰¾å›ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰æ“ä½œå†å²ï¼ˆåŒ…æ‹¬å·²åˆ é™¤çš„æäº¤ï¼‰
git reflog

# è¾“å‡ºç¤ºä¾‹ï¼š
# a1b2c3d HEAD@{0}: reset: moving to HEAD~1
# e4f5g6h HEAD@{1}: commit: æˆ‘è¯¯åˆ çš„æäº¤
# ...

# æ¢å¤åˆ°è¯¯åˆ çš„æäº¤
git reset --soft e4f5g6h
```

---

## ğŸ“‹ å®ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨

| æ“ä½œ | å‘½ä»¤ | è¯´æ˜ |
|------|------|------|
| æ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ï¼ˆä¿ç•™æ›´æ”¹ï¼‰ | `git reset --soft HEAD~1` | æœ€å¸¸ç”¨ â­ |
| æ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ï¼ˆä¸¢å¼ƒæ›´æ”¹ï¼‰ | `git reset --hard HEAD~1` | âš ï¸ å±é™© |
| æ’¤é”€ N æ¬¡æäº¤ | `git reset --soft HEAD~N` | N æ˜¯æ•°å­— |
| å®‰å…¨å›æ»šè¿œç¨‹æäº¤ | `git revert æäº¤hash` | æ¨è â­ |
| æŸ¥çœ‹æäº¤å†å² | `git log --oneline` | - |
| æŸ¥çœ‹æ“ä½œå†å² | `git reflog` | æ‰¾å›è¯¯åˆ çš„æäº¤ |
| æ’¤é”€æœªæš‚å­˜çš„æ–‡ä»¶ | `git checkout -- æ–‡ä»¶å` | - |
| å–æ¶ˆæš‚å­˜ | `git restore --staged æ–‡ä»¶å` | - |

---

## ğŸ¯ é’ˆå¯¹æ‚¨å½“å‰é¡¹ç›®çš„å»ºè®®

### å¦‚æœæ‚¨è¿˜æ²¡æœ‰æ¨é€åˆ° GitHubï¼š

```bash
# 1. æŸ¥çœ‹å½“å‰çŠ¶æ€
git status

# 2. æŸ¥çœ‹æäº¤å†å²
git log --oneline

# 3. æ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ï¼ˆä¿ç•™æ›´æ”¹ï¼‰
git reset --soft HEAD~1

# 4. æ£€æŸ¥æ–‡ä»¶çŠ¶æ€
git status

# 5. é‡æ–°æäº¤
git add .
git commit -m "æ–°çš„æäº¤ä¿¡æ¯"
```

### å¦‚æœæ‚¨å·²ç»æ¨é€åˆ° GitHubï¼š

#### æ¨èæ–¹æ³•ï¼ˆå®‰å…¨ï¼‰ï¼š
```bash
# ä½¿ç”¨ revert åˆ›å»ºæ–°æäº¤
git revert HEAD
git push origin main
```

#### å¼ºåˆ¶æ–¹æ³•ï¼ˆå¦‚æœæ‚¨ç¡®å®šæ²¡æœ‰å›¢é˜Ÿæˆå‘˜æ‹‰å–ï¼‰ï¼š
```bash
# æœ¬åœ°å›æ»š
git reset --hard HEAD~1

# å¼ºåˆ¶æ¨é€
git push --force-with-lease origin main
```

---

## âš ï¸ é‡è¦æç¤º

### reset çš„ä¸‰ç§æ¨¡å¼

| æ¨¡å¼ | å‘½ä»¤ | æäº¤ | æš‚å­˜åŒº | å·¥ä½œåŒº |
|------|------|------|--------|--------|
| `--soft` | `git reset --soft` | å›æ»š âœ… | ä¿ç•™ âœ… | ä¿ç•™ âœ… |
| `--mixed` (é»˜è®¤) | `git reset` | å›æ»š âœ… | æ¸…ç©º âŒ | ä¿ç•™ âœ… |
| `--hard` | `git reset --hard` | å›æ»š âœ… | æ¸…ç©º âŒ | æ¸…ç©º âŒ |

### å®‰å…¨å»ºè®®

1. âœ… **æœªæ¨é€åˆ°è¿œç¨‹**ï¼šéšæ„ä½¿ç”¨ `reset`
2. âš ï¸ **å·²æ¨é€åˆ°è¿œç¨‹**ï¼šä¼˜å…ˆä½¿ç”¨ `revert`
3. âŒ **å›¢é˜Ÿåä½œ**ï¼šé¿å…ä½¿ç”¨ `push --force`
4. âœ… **è¯¯æ“ä½œæ¢å¤**ï¼šä½¿ç”¨ `git reflog`

---

## ğŸ” å¿«é€Ÿè¯Šæ–­

### æˆ‘æƒ³è¦...

- â“ **æ’¤é”€åˆšæ‰çš„æäº¤ï¼Œä½†ä¿ç•™ä»£ç **ï¼Ÿ
  - â†’ `git reset --soft HEAD~1`

- â“ **å®Œå…¨æ”¾å¼ƒæœ€è¿‘çš„æäº¤å’Œä»£ç **ï¼Ÿ
  - â†’ `git reset --hard HEAD~1` âš ï¸

- â“ **å·²ç»æ¨é€åˆ° GitHubï¼Œæƒ³æ’¤é”€**ï¼Ÿ
  - â†’ `git revert HEAD` â­

- â“ **åªæƒ³ä¿®æ”¹æäº¤ä¿¡æ¯**ï¼Ÿ
  - â†’ `git commit --amend -m "æ–°æ¶ˆæ¯"`

- â“ **æ‰¾å›è¯¯åˆ çš„æäº¤**ï¼Ÿ
  - â†’ `git reflog` ç„¶å `git reset --soft æäº¤hash`

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å‘Šè¯‰æˆ‘æ‚¨çš„å…·ä½“æƒ…å†µï¼š
1. æ˜¯å¦å·²ç»æ¨é€åˆ° GitHubï¼Ÿ
2. æƒ³å›æ»šå‡ æ¬¡æäº¤ï¼Ÿ
3. æ˜¯å¦éœ€è¦ä¿ç•™ä»£ç æ›´æ”¹ï¼Ÿ

æˆ‘ä¼šç»™æ‚¨æœ€ç²¾å‡†çš„å‘½ä»¤ï¼
