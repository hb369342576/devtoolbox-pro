#syn_ods_cii_ship_status_report_d
env {
  # SeaTunnel 执行环境配置
  execution.parallelism = 1
  job.mode = "BATCH"
}

source {
  Jdbc {
	url = "jdbc:mysql://172.16.0.51:3306/shore_module_ruining?tinyInt1isBit=false"
    driver = "com.mysql.cj.jdbc.Driver"
    user = "ruining"
    password = "RuiNing@1015"
    query = """
      SELECT `id`, `status`, `loading_status`, `voyage_no`, `leg_no`, `report_date`, `report_time_zone`, `report_duration`, `latitude`, `longitude`, `distance`, `sailing_hours`, `navigation_direction`, `average_stw`, `average_sog`, `shore_power_consumed`, `current_stw`, `current_sog`, `departure_port`, `arrival_port`, `eta_time`, `eta_time_zone`, `wave_scale`, `current_velocity`, `wind_speed`, `swell_wave_direction`, `swell_wave_height`, `wind_direction`, `wave_direction`, `current_direction`, `charter_type`, `charter_service`, `service_speed`, `informant`, `create_time`, `update_time`, `delete_flag`, `report_status`, `data_status`, `fleet_code`, `ship_code`, `app_code`, `sig_wave`, `review_comments`, `unique_id`, `hs_hfo_cons`, `ls_hfo_cons`, `uls_hfo_cons`, `hs_lfo_cons`, `ls_lfo_cons`, `uls_lfo_cons`, `mdo_mgo_cons`, `river_boat_fuel_oil_cons`, `lng_cons`, `lpg_propane_cons`, `lpg_butane_cons`, `methanol_cons`, `ethanol_cons`, `hydrogen_cons`, `ammonia_cons`, `electric_power_cons`, `other_cons`, `hs_hfo_refueling`, `ls_hfo_refueling`, `uls_hfo_refueling`, `hs_lfo_refueling`, `ls_lfo_refueling`, `uls_lfo_refueling`, `mdo_mgo_refueling`, `river_boat_fuel_oil_refueling`, `lng_refueling`, `lpg_propane_refueling`, `lpg_butane_refueling`, `methanol_refueling`, `ethanol_refueling`, `hydrogen_refueling`, `ammonia_refueling`, `electric_power_refueling`, `other_refueling`, `ship_report_id`
      FROM cii_ship_status_report
    """
  }
}

sink {
  jdbc {
    driver = "com.mysql.cj.jdbc.Driver"
    url = "jdbc:mysql://192.168.9.200:9030/smart_cloud_pro"
    user = "root"
    password = "123456"
    query = "INSERT INTO ods_cii_ship_status_report_d (`id`, `status`, `loading_status`, `voyage_no`, `leg_no`, `report_date`, `report_time_zone`, `report_duration`, `latitude`, `longitude`, `distance`, `sailing_hours`, `navigation_direction`, `average_stw`, `average_sog`, `shore_power_consumed`, `current_stw`, `current_sog`, `departure_port`, `arrival_port`, `eta_time`, `eta_time_zone`, `wave_scale`, `current_velocity`, `wind_speed`, `swell_wave_direction`, `swell_wave_height`, `wind_direction`, `wave_direction`, `current_direction`, `charter_type`, `charter_service`, `service_speed`, `informant`, `create_time`, `update_time`, `delete_flag`, `report_status`, `data_status`, `fleet_code`, `ship_code`, `app_code`, `sig_wave`, `review_comments`, `unique_id`, `hs_hfo_cons`, `ls_hfo_cons`, `uls_hfo_cons`, `hs_lfo_cons`, `ls_lfo_cons`, `uls_lfo_cons`, `mdo_mgo_cons`, `river_boat_fuel_oil_cons`, `lng_cons`, `lpg_propane_cons`, `lpg_butane_cons`, `methanol_cons`, `ethanol_cons`, `hydrogen_cons`, `ammonia_cons`, `electric_power_cons`, `other_cons`, `hs_hfo_refueling`, `ls_hfo_refueling`, `uls_hfo_refueling`, `hs_lfo_refueling`, `ls_lfo_refueling`, `uls_lfo_refueling`, `mdo_mgo_refueling`, `river_boat_fuel_oil_refueling`, `lng_refueling`, `lpg_propane_refueling`, `lpg_butane_refueling`, `methanol_refueling`, `ethanol_refueling`, `hydrogen_refueling`, `ammonia_refueling`, `electric_power_refueling`, `other_refueling`, `ship_report_id`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);"
  }
}