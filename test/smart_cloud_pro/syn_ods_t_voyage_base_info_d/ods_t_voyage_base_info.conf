#syn_ods_t_voyage_base_info_d
env {
  # SeaTunnel 执行环境配置
  execution.parallelism = 1
  job.mode = "BATCH"
}

source {
  Jdbc {
    url = "jdbc:mysql://172.16.0.51:3306/zdflagdb?tinyInt1isBit=false"
    driver = "com.mysql.cj.jdbc.Driver"
    user = "ruining"
    password = "RuiNing@1015"
    query = """
      SELECT `id`, `ship_code`, `voyage_name`, `voyage_number`, `voyage_from`, `voyage_to`, `estimated_avg_speed`, `estimated_voyage_time`, `estimated_time_on_dept`, `real_time_on_dept`, `real_time_on_arrv`, `estimated_time_on_arrv`, `distance`, `real_distance`, `process_state`, `voyage_state`, `publish_time`, `upload_platform`, `source_type`, `source_person`, `publish_state_resp`, `error_state`, `voyage_state_resp`, `transport_state_resp`, `transport_state`, `resp_message`, `close_signal`, `close_signal_resp`, `draft`, `create_by`, `create_time`, `update_by`, `update_time`, `start_utc`, `end_utc`, `loading_port`, `bunkering_port`, `discharging_port`
      FROM t_voyage_base_info
    """
  }
}

sink {
  jdbc {
    driver = "com.mysql.cj.jdbc.Driver"
    url = "jdbc:mysql://192.168.9.200:9030/smart_cloud_pro"
    user = "root"
    password = "123456"
    query = "INSERT INTO ods_t_voyage_base_info_d (`id`, `ship_code`, `voyage_name`, `voyage_number`, `voyage_from`, `voyage_to`, `estimated_avg_speed`, `estimated_voyage_time`, `estimated_time_on_dept`, `real_time_on_dept`, `real_time_on_arrv`, `estimated_time_on_arrv`, `distance`, `real_distance`, `process_state`, `voyage_state`, `publish_time`, `upload_platform`, `source_type`, `source_person`, `publish_state_resp`, `error_state`, `voyage_state_resp`, `transport_state_resp`, `transport_state`, `resp_message`, `close_signal`, `close_signal_resp`, `draft`, `create_by`, `create_time`, `update_by`, `update_time`, `start_utc`, `end_utc`, `loading_port`, `bunkering_port`, `discharging_port`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);"
  }
}