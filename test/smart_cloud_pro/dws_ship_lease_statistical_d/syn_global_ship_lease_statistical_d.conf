#syn_global_dws_ship_lease_statistical_d
env {
  # SeaTunnel 执行环境配置
  execution.parallelism = 1
  job.mode = "BATCH"
}

source {
  Jdbc {
    url = "jdbc:mysql://192.168.9.200:9030/smart_cloud_pro"
    driver = "com.mysql.cj.jdbc.Driver"
    user = "root"
    password = "123456"
    query = """
     select `ship_code`, `voyage_no`, `avg_speed_good_weather_kn`, `cp_guaranteed_speed_kn`, `speed_deviation_kn`, `total_distance`, `est_time_delta_hr`, `time_status`, `good_weather_days`, `voyage_days`, `good_weather_ratio`, `fo_cons` as `hs_hfo_cons`, `ls_hfo_cons`, `uls_hfo_cons`, `hs_lfo_cons`, `ls_lfo_cons`, `uls_lfo_cons`, `go_cons` as `mdo_mgo_cons`, `river_boat_fuel_oil_cons`, `lng_cons`, `lpg_propane_cons`, `lpg_butane_cons`, `methanol_cons`, `ethanol_cons`, `hydrogen_cons`, `ammonia_cons`, `electric_power_cons`, `other_cons`, `create_time`, `update_time`, `cp_fo_guaranteed_mt_per_d`, `fo_cons_deviation_mt_per_d` from dws_ship_lease_statistical_d
    """
  }
}

sink {
  jdbc {
	url = "jdbc:mysql://172.16.0.51:3306/smart_cloud?tinyInt1isBit=false"
    driver = "com.mysql.cj.jdbc.Driver"
    user = "ruining"
    password = "RuiNing@1015"
    query = "REPLACE INTO global_ship_lease_statistical_d (`ship_code`, `voyage_no`, `avg_speed_good_weather_kn`, `cp_guaranteed_speed_kn`, `speed_deviation_kn`, `total_distance`, `est_time_delta_hr`, `time_status`, `good_weather_days`, `voyage_days`, `good_weather_ratio`, `hs_hfo_cons`, `ls_hfo_cons`, `uls_hfo_cons`, `hs_lfo_cons`, `ls_lfo_cons`, `uls_lfo_cons`, `mdo_mgo_cons`, `river_boat_fuel_oil_cons`, `lng_cons`, `lpg_propane_cons`, `lpg_butane_cons`, `methanol_cons`, `ethanol_cons`, `hydrogen_cons`, `ammonia_cons`, `electric_power_cons`, `other_cons`, `create_time`, `update_time`, `cp_fo_guaranteed_mt_per_d`, `fo_cons_deviation_mt_per_d`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
  }
}