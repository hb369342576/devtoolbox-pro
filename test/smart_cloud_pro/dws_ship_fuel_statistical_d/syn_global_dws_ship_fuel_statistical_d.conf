#syn_global_dws_ship_fuel_statistical_d
env {
  # SeaTunnel 执行环境配置
  execution.parallelism = 1
  job.mode = "BATCH"
}

source {
  Jdbc {
    url = "jdbc:mysql://192.168.9.200:9030/smart_cloud_pro"
    driver = "com.mysql.cj.jdbc.Driver"
    user = "root"
    password = "123456"
    query = """
      select `ship_code`, `voyage_no`, `status_code`, `report_date`, `vessel_name_cn`, `vessel_name_us`, `vessel_type_cn`, `vessel_type_us`, `status_cn`, `status_us`, `loading_status_code`, `loading_status_cn`, `loading_status_us`, `distance`, `sailing_hours`, `average_sog`, `start_port`, `end_port`, `voyage_distance`, `etd_utc`, `eta_utc`, `total_cons`, `fo_cons` as   `hs_hfo_cons`,  `ls_hfo_cons`, `uls_hfo_cons`, `hs_lfo_cons`, `ls_lfo_cons`, `uls_lfo_cons`, `go_cons` as `mdo_mgo_cons`, `river_boat_fuel_oil_cons`, `lng_cons`, `lpg_propane_cons`, `lpg_butane_cons`, `methanol_cons`, `ethanol_cons`, `hydrogen_cons`, `ammonia_cons`, `electric_power_cons`, `other_cons`, `total_margin`, `fo_margin` as `hs_hfo_margin`, `ls_hfo_margin`, `uls_hfo_margin`, `hs_lfo_margin`, `ls_lfo_margin`, `uls_lfo_margin`,  `go_margin` as `mdo_mgo_margin`, `river_boat_fuel_oil_margin`, `lng_margin`, `lpg_propane_margin`, `lpg_butane_margin`, `methanol_margin`, `ethanol_margin`, `hydrogen_margin`, `ammonia_margin`, `electric_power_margin`, `other_margin`, `me_fuel_consumption_one`, `alternator_fuel_consumption_one`, `boiler_fuel_consumption_one`, `me_fuel_consumption_two`, `alternator_fuel_consumption_two`, `boiler_fuel_consumption_two`, `me_fuel_consumption_three`, `alternator_fuel_consumption_three`, `boiler_fuel_consumption_three`, `me_fuel_consumption_four`, `alternator_fuel_consumption_four`, `boiler_fuel_consumption_four`, `me_fuel_consumption_five`, `alternator_fuel_consumption_five`, `boiler_fuel_consumption_five`, `me_fuel_consumption_six`, `alternator_fuel_consumption_six`, `boiler_fuel_consumption_six`, `create_time`, `update_time` from dws_ship_fuel_statistical_d
    """
  }
}

sink {
  jdbc {
	url = "jdbc:mysql://172.16.0.51:3306/smart_cloud?tinyInt1isBit=false"
    driver = "com.mysql.cj.jdbc.Driver"
    user = "ruining"
    password = "RuiNing@1015"
    query = "REPLACE INTO global_ship_fuel_statistical_d (`ship_code`, `voyage_no`, `status_code`, `report_date`, `vessel_name_cn`, `vessel_name_us`, `vessel_type_cn`, `vessel_type_us`, `status_cn`, `status_us`, `loading_status_code`, `loading_status_cn`, `loading_status_us`, `distance`, `sailing_hours`, `average_sog`, `start_port`, `end_port`, `voyage_distance`, `etd_utc`, `eta_utc`, `total_cons`,  `hs_hfo_cons`, `ls_hfo_cons`, `uls_hfo_cons`, `hs_lfo_cons`, `ls_lfo_cons`, `uls_lfo_cons`, `mdo_mgo_cons`, `river_boat_fuel_oil_cons`, `lng_cons`, `lpg_propane_cons`, `lpg_butane_cons`, `methanol_cons`, `ethanol_cons`, `hydrogen_cons`, `ammonia_cons`, `electric_power_cons`, `other_cons`, `total_margin`,  `hs_hfo_margin`, `ls_hfo_margin`, `uls_hfo_margin`, `hs_lfo_margin`, `ls_lfo_margin`, `uls_lfo_margin`, `mdo_mgo_margin`, `river_boat_fuel_oil_margin`, `lng_margin`, `lpg_propane_margin`, `lpg_butane_margin`, `methanol_margin`, `ethanol_margin`, `hydrogen_margin`, `ammonia_margin`, `electric_power_margin`, `other_margin`, `me_fuel_consumption_one`, `alternator_fuel_consumption_one`, `boiler_fuel_consumption_one`, `me_fuel_consumption_two`, `alternator_fuel_consumption_two`, `boiler_fuel_consumption_two`, `me_fuel_consumption_three`, `alternator_fuel_consumption_three`, `boiler_fuel_consumption_three`, `me_fuel_consumption_four`, `alternator_fuel_consumption_four`, `boiler_fuel_consumption_four`, `me_fuel_consumption_five`, `alternator_fuel_consumption_five`, `boiler_fuel_consumption_five`, `me_fuel_consumption_six`, `alternator_fuel_consumption_six`, `boiler_fuel_consumption_six`, `create_time`, `update_time`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
  }
}